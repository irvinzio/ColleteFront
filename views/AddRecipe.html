<!DOCTYPE html>
<html >
  <head>
    <title>Vive Diabetes</title>

    <!-- Viewport mobile tag for sensible mobile support -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../node_modules/bootstrap/dist/css/bootstrap.css">
    
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.5/angular.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-1.3.2.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.5/angular-animate.js"></script>
    <script>
    
    </script>
  </head>

  <body ng-app="app">
    <div ng-include="'../NavigationBar.html'"></div>


<div class="container" ng-controller="RecipeCtrl as vm">
      <pre>{{vm.recipeJson | json}}</pre>
       <div class="row">
         <div class="col-md-6">
           <div class="well">
               <div class="row ">  
                   <div class="col-xs-6 col-md-6">
                     <a href="#" class="thumbnail">
                       <img id="RecepiImg" src="#" alt="your image">
                     </a>
                     <!-- onchange="LoadThumbnail(this) -->
                     <input type="file" class="form-control" id="Image" ng-model="vm.recipeJson.recipe.url"  onchange="angular.element(this).scope().LoadThumbnail(this)"  data-max-size="vm.FileSize" accept="image/gif, image/jpeg, image/png">
                   </div>
                   <div class="col-xs-6 col-md-6">
                     <form>
                        <div class="form-group">
                            <select class="form-control" name="restaurantId" ng-options="bussines as bussines.name for bussines in vm.Bussines track by bussines.id" value="{{bussines.id}}"
                                                  ng-model="vm.recipeJson.recipe.idRestaurant" required>
                                                  <option value="opt">Select a Restaurant</option>
                            </select>
                          </div>
                          <div class="form-group">
                              <select class="form-control" name="category" ng-options="catalog as catalog.name for catalog in vm.CatalogArray[vm.IdCategoryId] track by catalog.id"
                                                    ng-model="vm.recipeJson.recipe.category" required>
                                                    <option value="opt">Select a category</option>
                              </select>
                            </div>
                       <div class="form-group">
                         <input type="text" ng-model="vm.recipeJson.recipe.name" class="form-control" id="Name" placeholder="Name">
                       </div>
                       <div class="form-group">
                         <input type="text" ng-model="vm.recipeJson.recipe.prepareTime" class="form-control" id="Time" placeholder="Time">
                       </div>
                       <div class="form-group">
                         <input type="text" ng-model="vm.recipeJson.recipe.diners" class="form-control" id="Diners" placeholder="Diners">
                       </div>
                     </form>
                   </div>
               </div>
           </div>
           <div class="well">
               <div class="row">
                 <div class="col-md-12 navbar-text">
                     <form>
                        <div class="form-group col-md-6">
                            <input type="text" class="form-control" placeholder="Unit name" disabled ng-model="vm.IngrdientSelected.idUnit.Name">
                        </div>
                        <div class="form-group col-md-6">
                          <div class="input-group"> 
                            <input type="number" ng-model="vm.IngrdientSelected.qty" 
                            ng-change="vm.UpdateIngredietnValues(vm.IngrdientSelected)" class="form-control" placeHolder="Quantity" value="1">
                          </div>
                        </div>
                         <div class="form-group col-md-8" >
                           <div class="input-group"> 
                             <input type="text" ng-model="vm.IngrdientSelected" 
                             ng-change="vm.GetIngredientByName(vm.IngrdientSelected)" class="form-control" placeHolder="Add Ingridient" uib-typeahead="Ingridients as Ingridients.name for Ingridients in vm.Ingredients | filter:{name:$viewValue}"
                             typeahead-on-select="vm.UpdateInfo(vm.IngrdientSelected)" typeahead-show-hint="true" typeahead-min-length="0">
                           </div>
                         </div> 
                         <div class="form-group col-md-4" >
                            <div class="input-group"> 
                                <button type="submit" ng-click="vm.AddIngredient(vm.IngrdientSelected)" class="btn btn-primary col-md-12"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span></button>
                            </div>
                         </div>
                       </form>
                 </div>
               </div>
               <div class="row">
                 <div class="col-md-12">
                   <form>
                     <div class="form-group">
                       <ul class="nav nav-pills" role="tablist">
                         <li role="presentation" class="active"><a href="#">Energy K <span class="badge">{{vm.IngredientSelected.energyK}}</span></a></li>
                         <li role="presentation" class="active"><a href="#">Lipids <span class="badge">{{vm.IngredientSelected.lipids}}</span></a></li>
                         <li role="presentation" class="active"><a href="#">Carbohydrates <span class="badge">{{vm.IngredientSelected.carbohydrates}}</span></a></li>
                         <li role="presentation" class="active"><a href="#">Protein <span class="badge">{{vm.IngredientSelected.protein}}</span></a></li>
                       </ul>
                     </div>
                   </form>
                 </div>
               </div>
                 <div class="row">
                   <div class="col-md-12">
                     <!-- Table -->
                     <table class="table table-striped">
                           <thead>
                               <tr>
                                   <th>Ingredient</th>
                               </tr>
                           </thead>
                           <tbody>
                               <tr ng-repeat="ingredient in vm.recipeJson.recipe_ingredient">    
                                <!-- <td>
                                      <span ng-show="ingredient.editMode == null || ingredient.editMode == false">{{ingredient.qty}}</span>
                                    <input type="number" ng-keyup="$event.keyCode == 13 ? vm.IngridientDataCancelEditMode() : null" ng-show="ingredient.editMode == true" ng-model="ingredient.qty" ng-change="vm.UpdateIngredientInfo(ingredient)"
                                    value="{{ingredient.qty}}">
                                  
                                  </td> -->
                                  <td>{{ingredient.UnitName}}</td>
                                  <td>{{ingredient.qty}}</td>
                                   <td>{{ingredient.name}}</td>
                                   <td><a href="#recipe" ng-click="vm.IngredientconfirmationModal(ingredient,$index)" title="eliminar"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></a></td>
                                   <td><a href="#recipe" ng-click="vm.updateIngridientData(ingredient)" title="editar"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></a>
                           </p></span></td>
                               </tr>       
                           </tbody>
                      </table>
                   </div>
                 </div>
             </div>
             <div class="well">
                 <div class="row">
                   <div class="col-md-12 navbar-text">
                       <form class="form-inline">
                         <div class="form-group"  style="width: 100%">
                           <label class="sr-only" for="AddIngridient">Add Step</label>
                           <div class="input-group col-md-10">
                             <input type="text" class="form-control" ng-model="vm.StepToAdd" id="AddStep" placeholder="Add Step">
                           </div>
                           <button type="submit" ng-click="vm.AddStep(vm.StepToAdd)" class="btn btn-primary"><span class="glyphicon glyphicon-plus" aria-hidden="true"></button>
                         </div> 
                       </form>
                   </div>
                 </div>   
                 <div class="row">
                   <div class="col-md-12">
                     <!-- Table -->
                     <table class="table table-striped">
                           <thead>
                               <tr>
                                   <th>Steps</th>
                               </tr>
                           </thead>
                           <tbody>
                               <tr ng-repeat="step in vm.recipeJson.recipe_procedure ">
                                  <td><input type="number" ng-model="step.orderNo" value="{{step.orderNo}}"></td>
                                   <td>{{step.description}}</td>
                                   <td><a href="#recipe" ng-click="vm.StepsconfirmationModal(step,$index)" title="eliminar"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></a></td>
                                   <td><a href="#recipe" ng-click="vm.updateData(step)" title="editar"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span></a>
                           </p></span></td>
                               </tr>       
                           </tbody>
                      </table>
                   </div>
                 </div>
             </div>
         </div>
           <div class="col-md-6">
             <div class="row well">
               <!-- Table -->
               <table class="table table-striped">
                  <table class="table table-striped">
                      <thead>
                          <tr>
                              <th>Nutrition Facts</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr ng-repeat="(key, value) in vm.recipeJson.nutrition_facts">
                              <td>{{key}}</td>
                              <td>{{value}}</td>
                          </tr>       
                      </tbody>
                 </table>
             </div>
             <div class="row">
               <div class="col-md-12 text-center">
                 <button type="button" ng-click="vm.SaveRecepi(vm.recipeJson)" class="btn btn-primary"><span class="glyphicon glyphicon-floppy-disk" aria-hidden="true"></span></button>
               </div>
             </div>
           </div>
       </div>

    </div>

    <!--<script src="../../node_modules/angular/angular.js"></script>-->
    <script src="../../node_modules/angular-route/angular-route.js"></script>
    <script src="../../node_modules/bootstrap/dist/js/bootstrap.js"></script>
    <script src="../../app.js"></script>
    <script src="../../Controllers/IngredientController.js"></script>
    <script src="../../Controllers/RecipeController.js"></script>
    <script src="../../services/IngredientService.js"></script>
    <script src="../../services/RecipeService.js"></script>
    <script src="../../services/BussinesService.js"></script>
    <script src="../../services/UserService.js"></script>
    <script src="../../services/CatalogService.js"></script>
    <script src="../../services/JsPopupService.js"></script>
  </body>
</html>